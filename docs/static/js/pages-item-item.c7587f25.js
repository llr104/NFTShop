(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-item-item"],{"03c5":function(t,o,i){var n=i("430b");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var e=i("4f06").default;e("6d3808fb",n,!0,{sourceMap:!1,shadowMode:!1})},"2c5b":function(t,o,i){"use strict";i.r(o);var n=i("b610"),e=i("9245");for(var a in e)"default"!==a&&function(t){i.d(o,t,(function(){return e[t]}))}(a);i("c16b");var s,r=i("f0c5"),c=Object(r["a"])(e["default"],n["b"],n["c"],!1,null,"13f958ff",null,!1,n["a"],s);o["default"]=c.exports},"430b":function(t,o,i){var n=i("24fb"),e=i("1de5"),a=i("303a");o=n(!1);var s=e(a);o.push([t.i,'@charset "UTF-8";\n/* 水平间距 */\n/* 水平间距 */.c[data-v-13f958ff]{padding:%?20?% %?20?% 0 %?20?%}.product-image[data-v-13f958ff]{width:100%}.product-title[data-v-13f958ff]{margin-left:%?20?%}.center-card[data-v-13f958ff]{border-radius:%?40?%;background-color:#d9dcde;margin:%?30?%;padding:%?40?%}.center-card .one-margin[data-v-13f958ff]{margin-bottom:%?40?%}.center-card .one[data-v-13f958ff]{position:relative}.center-card .one .one-1[data-v-13f958ff]{color:#8c9fad}.center-card .one .one-2[data-v-13f958ff]{margin-left:%?10?%;color:#000}.center-card .one .nftAddress[data-v-13f958ff]::after{display:inline-block;position:absolute;content:"";width:%?30?%;height:%?30?%;right:%?20?%;background:url('+s+') 50% no-repeat}.center-card .one .o-copy[data-v-13f958ff]{vertical-align:middle;width:%?40?%;height:%?40?%}.center-card .one .home[data-v-13f958ff]{display:inline-block;float:right;color:#8c9fad;font-size:%?25?%;line-height:%?30?%;margin-right:%?60?%}.center-card .one .home[data-v-13f958ff]::after{display:inline-block;position:absolute;content:"";width:%?30?%;height:%?30?%;right:%?20?%;background:url('+s+') 50% no-repeat}.subTitle[data-v-13f958ff]{margin-left:%?10?%;margin-top:%?20?%}.product-des[data-v-13f958ff]{margin:%?0?% %?30?% %?20?% %?30?%;word-break:break-all;display:-webkit-box;overflow:hidden;text-overflow:ellipsis;color:#5e697a;font-size:%?28?%;line-height:1.5}.record[data-v-13f958ff]{vertical-align:middle}.record .saleTitle[data-v-13f958ff]{display:inline-block}.record .more[data-v-13f958ff]{display:inline-block;position:relative;height:100%;float:right;right:%?50?%;top:%?50?%;font-size:%?30?%;color:#5e697a}.record .more[data-v-13f958ff]::after{display:inline-block;position:absolute;content:"";width:%?30?%;height:%?30?%;margin-top:%?10?%;right:%?-30?%;background:url('+s+") 50% no-repeat}.t[data-v-13f958ff]{height:%?100?%;width:100%;background-color:#fff}.t .tt[data-v-13f958ff]{margin-left:%?30?%}.bottom[data-v-13f958ff]{width:100%;height:%?100?%;background-color:#fff}.bottom .space[data-v-13f958ff]{width:100%;height:%?100?%}.bottom .bottom-fixed[data-v-13f958ff]{position:fixed;left:0;bottom:0;width:100%;z-index:1;line-height:%?100?%;background-color:#fff}.bottom .bottom-fixed .price[data-v-13f958ff]{float:left;display:inline-block;margin-left:%?50?%;font-weight:bolder;font-size:%?40?%;color:#ff56a7}.bottom .bottom-fixed .upSale[data-v-13f958ff],\n.bottom .bottom-fixed .upSaling[data-v-13f958ff],\n.bottom .bottom-fixed .open[data-v-13f958ff],\n.bottom .bottom-fixed .downSale[data-v-13f958ff],\n.bottom .bottom-fixed .downSaling[data-v-13f958ff]{float:right;display:inline-block;vertical-align:middle;width:%?250?%;height:%?80?%;background-color:#000;border-radius:%?30?%;text-align:center;line-height:%?80?%;font-weight:700;color:#fff;margin:%?10?% %?20?%}.bottom .bottom-fixed .buy[data-v-13f958ff],\n.bottom .bottom-fixed .buying[data-v-13f958ff]{float:right;display:inline-block;vertical-align:middle;width:%?250?%;height:%?80?%;background-color:#000;border-radius:%?30?%;text-align:center;line-height:%?80?%;font-weight:700;color:#fff;margin:%?10?% %?20?%}.bottom .bottom-fixed .SaleOut[data-v-13f958ff]{float:right;display:inline-block;vertical-align:middle;width:%?250?%;height:%?80?%;background-color:#e7e7e7;border-radius:%?30?%;text-align:center;line-height:%?80?%;font-weight:700;color:#000;margin:%?10?% %?20?%}.ph[data-v-13f958ff]{height:%?800?%;z-index:2;touch-action:none}.sh[data-v-13f958ff]{width:100%;height:%?700?%;background-color:#fff}.downSale_popup .c[data-v-13f958ff]{width:100%;height:%?280?%;background-color:#fff}.downSale_popup .c .t[data-v-13f958ff]{margin-left:%?50?%}.downSale_popup .c .downSaleBtnLeft[data-v-13f958ff]{float:left;margin-left:%?50?%;width:35%;border-radius:%?20?%}.downSale_popup .c .downSaleBtnRight[data-v-13f958ff]{float:right;margin-right:%?50?%;width:35%;background-color:#000;color:#fff;border-radius:%?20?%}.buy_confirm .c[data-v-13f958ff]{width:100%;height:%?300?%;background-color:#fff}.buy_confirm .c .t[data-v-13f958ff]{margin-left:%?50?%}.buy_confirm .c .uri[data-v-13f958ff]{float:left;width:%?140?%;height:%?140?%;border-radius:%?20?%;margin-left:%?20?%;display:inline-block}.buy_confirm .c .l[data-v-13f958ff]{float:left;margin-top:%?10?%;margin-left:%?30?%}.buy_confirm .c .l1[data-v-13f958ff]{color:#8c9fad;font-size:%?28?%;line-height:1.5}.buy_confirm .c .l2[data-v-13f958ff]{color:red;font-size:%?28?%;line-height:1.5}.buy_confirm .c .pay[data-v-13f958ff]{width:%?200?%;background-color:#000;color:#fff;font-weight:700;margin-top:%?10?%}.buy_confirm .c .approve[data-v-13f958ff]{width:%?200?%;background-color:#000;color:#fff;font-weight:700;margin-top:%?10?%}.buy_confirm .c .approving2[data-v-13f958ff]{width:%?250?%;background-color:#000;color:#fff;font-weight:700;margin-top:%?10?%}",""]),t.exports=o},9245:function(t,o,i){"use strict";i.r(o);var n=i("d072"),e=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(o,t,(function(){return n[t]}))}(a);o["default"]=e.a},b610:function(t,o,i){"use strict";i.d(o,"b",(function(){return e})),i.d(o,"c",(function(){return a})),i.d(o,"a",(function(){return n}));var n={navigation:i("64c8").default,uniTitle:i("8ce4").default,uniPopup:i("4fec").default},e=function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("v-uni-view",[n("navigation"),t.isFound?n("v-uni-view",{staticClass:"c"},[n("v-uni-image",{staticClass:"product-image",attrs:{src:t.product.uri,mode:"widthFix"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickImg.apply(void 0,arguments)}}}),n("uni-title",{staticClass:"product-title",attrs:{title:t.product.name}}),n("v-uni-view",{staticClass:"center-card"},[n("v-uni-view",{staticClass:"one one-margin",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickContactAddress.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"one-1"},[t._v("合约地址:")]),n("v-uni-text",{staticClass:"one-2 nftAddress"},[t._v(t._s(t.addressShow(t.nftAddress)))])],1),n("v-uni-view",{staticClass:"one one-margin"},[n("v-uni-text",{staticClass:"one-1"},[t._v("链上标志:")]),n("v-uni-text",{staticClass:"one-2"},[t._v(t._s(t.product.id))])],1),n("v-uni-view",{staticClass:"one"},[n("v-uni-text",{staticClass:"one-1"},[t._v("拥有者   :")]),n("v-uni-text",{staticClass:"one-2 oAddress"},[t._v(t._s(t.addressShow(t.product.ownerAddress)))]),n("v-uni-image",{staticClass:"o-copy",attrs:{src:i("6c0d")},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickOnwerAddress.apply(void 0,arguments)}}}),n("v-uni-text",{staticClass:"home",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickOwnerHome.apply(void 0,arguments)}}},[t._v("个人主页")])],1)],1),n("uni-title",{staticClass:"subTitle",attrs:{type:"h3",title:"作品描述"}}),n("v-uni-text",{staticClass:"product-des"},[t._v(t._s(t.product.describe))]),n("v-uni-view",{staticClass:"record"},[n("uni-title",{staticClass:"subTitle saleTitle",attrs:{type:"h3",title:"交易记录"}}),n("v-uni-text",{staticClass:"more",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickMore.apply(void 0,arguments)}}},[t._v("更多")])],1),n("transaction-list",{ref:"txlist1",attrs:{txEvents:t.txEvents,unitSymbol:t.tokenSymbol},on:{clickLink:function(o){arguments[0]=o=t.$handleEvent(o),t.clickLink.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"bottom"},[n("v-uni-view",{staticClass:"bottom-fixed"},[t.product.price?n("v-uni-view",{staticClass:"price"},[t._v(t._s(t.product.showPrice)+" "+t._s(t.tokenSymbol))]):t._e(),t.downSaling?n("v-uni-button",{staticClass:"downSaling",attrs:{type:"default",loading:"true"}},[t._v("下架中...")]):t.upSaling?n("v-uni-button",{staticClass:"upSaling",attrs:{type:"default",loading:"true"}},[t._v("上架中...")]):t.buying?n("v-uni-button",{staticClass:"buying",attrs:{type:"default",loading:"true"}},[t._v("购买中...")]):!t.product.price&&t.isSameAddress(t.myAddress,t.product.ownerAddress)?n("v-uni-button",{staticClass:"upSale",attrs:{type:"default"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickUpSale.apply(void 0,arguments)}}},[t._v("立即挂售")]):t.product.price&&t.isSameAddress(t.myAddress,t.product.ownerAddress)?n("v-uni-button",{staticClass:"downSale",attrs:{type:"default"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickDownSale.apply(void 0,arguments)}}},[t._v("取消挂售")]):t.product.price?n("v-uni-button",{staticClass:"buy",attrs:{type:"default"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickBuy.apply(void 0,arguments)}}},[t._v("立即购买")]):t.product.price?t._e():n("v-uni-button",{staticClass:"SaleOut",attrs:{type:"default"}},[t._v("已售罄")])],1),n("v-uni-view",{staticClass:"space"})],1),n("uni-popup",{ref:"downSale_popup",staticClass:"downSale_popup",attrs:{type:"top"}},[n("v-uni-view",{staticClass:"c"},[n("uni-title",{staticClass:"t",attrs:{title:"您确定取消挂售吗？",type:"h1"}}),n("v-uni-button",{staticClass:"downSaleBtnLeft",attrs:{type:"default"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.downSaleCancle.apply(void 0,arguments)}}},[t._v("取消")]),n("v-uni-button",{staticClass:"downSaleBtnRight",attrs:{type:"default"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.downSaleOK.apply(void 0,arguments)}}},[t._v("确定")])],1)],1),n("uni-popup",{ref:"buy_confirm",staticClass:"buy_confirm"},[n("v-uni-view",{staticClass:"c"},[n("uni-title",{staticClass:"t",attrs:{title:"订单信息",type:"h2"}}),n("v-uni-view",{staticClass:"uri"},[n("v-uni-image",{staticClass:"uri",attrs:{src:t.product.uri,mode:""}})],1),n("v-uni-view",{staticClass:"l"},[n("v-uni-view",{staticClass:"l1"},[n("v-uni-text",[t._v(t._s(t.product.name))])],1),n("v-uni-view",{staticClass:"l1"},[n("v-uni-text",[t._v("链上标识:"+t._s(t.product.id))])],1),n("v-uni-view",{staticClass:"l2"},[n("v-uni-text",[t._v("价格:"+t._s(t.product.showPrice)+" "+t._s(t.tokenSymbol))])],1)],1),t.approving?n("v-uni-button",{staticClass:"approving2",attrs:{type:"default",loading:"true"}},[t._v("授权中...")]):0==t.isApprove&&0==t.approving?n("v-uni-button",{staticClass:"approve",attrs:{type:"default"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickApprove.apply(void 0,arguments)}}},[t._v("授权")]):n("v-uni-button",{staticClass:"pay",attrs:{type:"default"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.clickPay.apply(void 0,arguments)}}},[t._v("支付")])],1)],1)],1):t._e(),n("uni-popup",{ref:"ph_popup",staticClass:"ph",attrs:{type:"bottom"}},[n("v-uni-view",{staticClass:"t"},[n("uni-title",{staticClass:"tt",attrs:{title:"交易记录",type:"h2"}})],1),n("v-uni-scroll-view",{staticClass:"sh",attrs:{"scroll-y":"true"}},[n("transaction-list",{ref:"txlist2",attrs:{txEvents:t.txEvents,unitSymbol:t.tokenSymbol},on:{clickLink:function(o){arguments[0]=o=t.$handleEvent(o),t.clickLink.apply(void 0,arguments)}}})],1)],1)],1)},a=[]},c16b:function(t,o,i){"use strict";var n=i("03c5"),e=i.n(n);e.a},d072:function(t,o,i){"use strict";var n=i("4ea4");i("99af"),i("a9e3"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var e=i("a735"),a=n(i("64c8")),s=n(i("232a")),r=n(i("cac6")),c=i("f248"),l=i("4e74"),d=i("4f87"),f=i("1c52"),u=d.getETH(),p=(d.getProvider(),{components:{navigation:a.default,transactionItem:s.default,transactionList:r.default},data:function(){return{nftAddress:"",isFound:!1,myAddress:"",isApprove:!1,downSaling:!1,upSaling:!1,buying:!1,approving:!1,product:{},txEvents:[],tokenSymbol:""}},onPullDownRefresh:function(){this.queryToken(this.id),uni.stopPullDownRefresh()},onLoad:function(t){var o=this;if(console.log("item onLoad"),this.addressShow=e.addressShow,this.toTokenValue=d.toTokenValue,this.isSameAddress=e.isSameAddress,u.getAccounts((function(t,i){t||0==i.length||(o.myAddress=i[0])})),uni.$on("accountChanged",(function(t){o.myAddress=t})),t.id){var i=Number(t.id);this.id=i,uni.$on("receiptHash",(function(t,n){t&&Number(t.tokenId)==i&&(t.op==f.opType.ApprovingToken?o.approving=!1:t.op==f.opType.UpSalling?o.upSaling=!1:t.op==f.opType.DownSaling?o.downSaling=!1:t.op==f.opType.Buying&&(o.buying=!1),o.queryToken(i))})),this.queryToken(i)}},onUnload:function(){uni.$off("accountChanged"),uni.$off("receiptHash")},methods:{queryToken:function(t){var o=this;console.log("queryToken:",t),d.ready((function(){o.nftAddress=(0,c.nftAddress)(),o.tokenSymbol=d.getTokenSymbol(),o.tokenDecimals=d.getTokenDecimals(),d.queryToken(t,(function(t,i){if(t)o.isFound=!1;else{o.isFound=!0,o.product=i;var n=f.getTransactionPennding(i.id);if(n)for(var e=0;e<n.length;e++){var a=n[e];console.log("hashObj:",a),a.op==f.opType.ApprovingToken?o.approving=!0:a.op==f.opType.UpSalling?o.upSaling=!0:a.op==f.opType.DownSaling?o.downSaling=!0:a.op==f.opType.Buying&&(o.buying=!0)}}})),o.qryTX(t)}))},qryTX:function(t){var o=this,i=d.getNFT();this.txEvents=[],u.getBlockNumber((function(n,e){if(!n){e=Number(e);for(var a=(0,c.fromBlock)();a<=e;a+=5e3){var s=Math.min(e,a+5e3);i.getPastEvents("SetOnSale",{filter:{_tokenId:t+""},fromBlock:a,toBlock:s},(function(t,i){t||(o.txEvents=o.txEvents.concat(i),o.$refs.txlist1&&o.$refs.txlist1.reload(o.txEvents,4),o.$refs.txlist2&&o.$refs.txlist2.reload(o.txEvents))}))}}}))},clickContactAddress:function(){console.log("clickContactAddress"),(0,l.openAddress)((0,c.nftAddress)())},clickOnwerAddress:function(){console.log("clickOnwerAddress:",this.product.ownerAddress),(0,e.copy)(this.product.ownerAddress,(function(t){t||uni.showToast({title:"复制成功"})}))},clickOwnerHome:function(){console.log("clickOwnerHome"),uni.navigateTo({url:"../others/others?address="+this.product.ownerAddress,complete:function(t){console.log(t)}})},clickBuy:function(){var t=this;console.log("clickBuy"),this.$refs.buy_confirm.open("bottom"),d.isApproveToken(this.myAddress,(function(o,i){!o&&i>=t.product.price?t.isApprove=!0:t.isApprove=!1}))},clickMore:function(){var t=this;console.log("clickMore"),this.$refs.ph_popup.open("bottom"),setTimeout((function(){t.$refs.txlist2&&t.$refs.txlist2.reload(t.txEvents)}),100)},clickLink:function(t){(0,l.openTxHash)(t)},clickUpSale:function(){console.log("clickUpSale"),uni.navigateTo({url:"../resell/resell?id="+this.product.id,complete:function(t){console.log(t)}})},clickDownSale:function(){console.log("clickDownSale"),this.$refs.downSale_popup.open("bottom")},downSaleCancle:function(){console.log("downSaleCancle"),this.$refs.downSale_popup.close()},downSaleOK:function(){var t=this;console.log("downSaleOK"),this.$refs.downSale_popup.close();var o=d.getNFT();o.methods.setTokenPrice(this.product.id,0).send({from:this.myAddress}).on("transactionHash",(function(o){t.downSaling=!0,f.setTransactionPennding(t.product.id,o,f.opType.DownSaling)})).on("receipt",(function(o){console.log("receipt:",o),t.downSaling=!1,o.status?(uni.showToast({title:"取消挂售成功"}),t.product.price=0):uni.showToast({title:"取消挂售失败",icon:"error"})})).on("error",(function(o){t.downSaling=!1,uni.showToast({title:"取消挂售失败",icon:"error"})}))},clickApprove:function(){var t=this;console.log("clickApprove"),this.approving=!0;var o=this.product.price;d.approveToken(this.myAddress,o).on("transactionHash",(function(o){f.setTransactionPennding(t.product.id,o,f.opType.ApprovingToken)})).on("receipt",(function(o){t.approving=!1,t.isApprove=!0})).on("error",(function(o){t.approving=!1}))},clickPay:function(){var t=this;this.$refs.buy_confirm.close(),console.log("clickPay",this.product.id,this.myAddress,this.product.price),d.buy(this.product.id,this.myAddress,this.product.price).on("transactionHash",(function(o){t.buying=!0,uni.navigateTo({url:"../buy-result/buy-result?id="+t.product.id+"&hash="+o,complete:function(t){console.log(t)}})})).on("error",(function(o){t.downSaling=!1,uni.showToast({title:"购买失败",icon:"error"})}))},clickImg:function(){uni.previewImage({urls:[this.product.uri]})}}});o.default=p}}]);